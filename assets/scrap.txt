
<!doctype html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <title>Responsive Charts with D3 | Visible Data</title>

  <script src="d3.min.js" type="text/javascript"></script>

</head>
<body>
  <style type="text/css">

.domain { 
  fill: none; 
  stroke: black; 
  shape-rendering: crispEdges;
  stroke-width: 0;
} 

.bar rect {
    stroke: #fff;
    shape-rendering: crispEdges;
}

.bar rect.background {
    fill: #eee;
}

.bar rect.percent {
    fill: #74c476;
    stroke: #74c476;
}

.bar:hover rect.percent {
    fill: #a1d99b;
}

.bar text {
    font-size: 12px;
    fill: #333;
}

.axis line {
    stroke: #ccc;
    stroke-width: 1;
}

line.line {
    stroke: #777;
    stroke-width: 1;
}

line.median {
    stroke: #777;
    stroke-width: 1;
}

.lineTitle{
  font-size: 12px;
}

</style>

<div id="chart">
</div>


<script type="text/javascript">
var url = "/bachelors-degrees.csv"
  , margin = {top: 30, right: 10, bottom: 30, left: 10}
  , width = parseInt(d3.select('#chart').style('width'), 10)
  , width = width - margin.left - margin.right
  , height = 100 // placeholder
  , barHeight = 20
  , spacing = 3
  , percent = d3.format('%');

// scales and axes
var x = d3.scale.linear()
    .range([0, width])
    .domain([0, 50]); // hard-coding this because I know the data

var y = d3.scale.ordinal();

var xAxis = d3.svg.axis()
    .scale(x);

var json_data = [1,4,6,10,14,14,15,20,50,10,2,4,4];

// create the chart
var chart = d3.select('#chart').append('svg')
    .style('width', (width + margin.left + margin.right) + 'px')
  .append('g')
    .attr('transform', 'translate(' + [margin.left, margin.top] + ')');

    data = json_data;

    line_data = [6,8,12];

    barHeight = height / data.length;

    // set y domain
    y.domain(d3.range(data.length))
        .rangeBands([0, data.length * barHeight]);

    // set height based on data
    height = y.rangeExtent()[1];
    d3.select(chart.node().parentNode)
        .style('height', (height + margin.top + margin.bottom) + 'px')

    // render the chart

    // add top and bottom axes

    chart.append('g')
        .attr('class', 'x axis bottom')
        .attr('transform', 'translate(0,' + height + ')')
        .call(xAxis.orient('bottom'));

    var bars = chart.selectAll('.bar')
        .data(data)
      .enter().append('g')
        .attr('class', 'bar')
        .attr('transform', function(d, i) { return 'translate(0,'  + y(i) + ')'; });

    var lines = chart.selectAll('.line')
        .data(line_data)
      .enter().append('line')
        .attr('class', 'line')
        .attr('x1', function(d){ return x(d); })
        .attr('x2', function(d){ return x(d); })
        .attr('y1', 0)
        .attr('y2', height);

    var lines = chart.selectAll('.lineTitle')
        .data(line_data)
      .enter().append('text')
        .text(function(d) { return d; })
        .attr('class', 'lineTitle')
        .attr("transform", function(d){ return "translate("+x(d)+",0)"; });


    bars.append('rect')
        .attr('class', 'percent')
        .attr('height', y.rangeBand())
        .attr('width', function(d) { return x(d); })

// resize
d3.select(window).on('resize', resize); 

function resize() {
    // update width
    width = parseInt(d3.select('#chart').style('width'), 10);
    width = width - margin.left - margin.right;

    // resize the chart
    x.range([0, width]);
    d3.select(chart.node().parentNode)
        .style('height', (y.rangeExtent()[1] + margin.top + margin.bottom) + 'px')
        .style('width', (width + margin.left + margin.right) + 'px');

    chart.selectAll('rect.background')
        .attr('width', width);

    chart.selectAll('rect.percent')
        .attr('width', function(d) { return x(d); });

    // update median ticks
  
    chart.selectAll('line.line')
        .attr('x1', function(d){ return x(d); })
        .attr('x2', function(d){ return x(d); });

    chart.selectAll('.lineTitle')
      .attr("transform", function(d){ return "translate("+x(d)+",0)"; });

    // update axes
    chart.select('.x.axis.bottom').call(xAxis.orient('bottom'));

}

</script>

</body>
</html>
